runner: "episode_runner"
mac: "basic_mac"
learner: "q_learner"

t_max: 5000
test_interval: 2000
test_nepisode: 2

n_agents: 3
belief_dim: 128
population_belief_dim: 1
text_embed_dim: 1024
batch_size_run: 1
n_actions: 5
max_seq_length: 1024

# hisim_social_env 消费 LLM 输出的 action JSON（action_type/stance_id/post_text）
env_action_source: "llm_response_0"

# 在线仿真需要启用 LLM rollout
enable_llm_rollout: true

# llm_model_name 仅用于本地 tokenizer（不要填 OpenAI 模型名）
llm_model_name: "gpt2"

together_api_key: "${TOGETHER_API_KEY}"
coordinator_model: "gpt-3.5-turbo"
executor_model: "gpt-3.5-turbo"
commitment_embedding_model_name: "BAAI/bge-large-en-v1.5"

# 若 provider 支持 response_format，可开启 JSON mode（env 侧也有 JSON 修复兜底）
llm_response_format_json: true

env: "hisim_social_env"
env_args:
  hisim_data_root: "${HISIM_DATA_ROOT}"
  topic: "metoo"
  event: "e1"
  max_question_length: 1024
  max_answer_length: 512

  # stance label -> id 映射需与离线数据集一致
  label2id_path: "./assets/label2id/metoo_e1.json"

  n_stages: 13
  max_neighbor_posts: 8
  max_population_texts: 20

  max_user_history_lines: 40
  max_recent_self_posts: 6

  use_secondary_belief_sim: true
  secondary_sim_max_users: 700
  secondary_sim_use_micro_texts: true

  expected_core_users: 300
  expected_edge_users: 700
  strict_user_counts: false

  z_alpha: 0.03
  z_decay: 0.995
  population_belief_mode: "scalar"

  reward_w_action_type: 0.2
  reward_w_stance: 0.7
  reward_w_text: 0.3
  mask_missing_gt: true
  min_edge_labels_for_z_target: 200

curriculum:
  enabled: true
  t_env_steps: [20000, 60000]
  n_stages: [7, 10, 13]

z_transition_loss_weight: 1.0
z_transition_loss_type: "mse"

use_secondary_action_head: false

train:
  episodes_per_task: 1
  buffer_size: 32
  batch_size: 8
  update_interval: 10
  optimizer: "adam"
  learning_rate: 0.001
  coordinator_learning_rate: 0.0005
  gamma: 0.99

system:
  use_cuda: true
  device_num: 0
  seed: 42
  debug: true

logging:
  use_tensorboard: true
  log_interval: 1
  save_model: true
  save_model_interval: 2000
  checkpoint_path: "./models"
  log_path: "./logs"
  experiment_name: "hisim-social-sim"


